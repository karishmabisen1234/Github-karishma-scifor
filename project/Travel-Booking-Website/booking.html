<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Karishma Travel | Booking</title>
  <style>
   /* ===== BASIC ===== */
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f2f2f2;
}

h2 {
  text-align: center;
  color: #ff3b3b;
  margin: 20px 0;
}

/* ===== HEADER ===== */
header {
  background: #ff3b3b;
  color: white;
  padding: 20px;
  text-align: center;
}

header nav a {
  color: white;
  text-decoration: none;
  margin: 0 15px;
  font-weight: bold;
}

header nav a:hover {
  color: #e60000;
}

/* ===== BOOKING FORM ===== */

.booking-container {
  max-width: 600px;
  margin: 30px auto;
  padding: 25px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
}

label {
  display: block;
  margin: 12px 0 6px;
  font-weight: bold;
}

/* Inputs & Select */

select,
input {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  font-size: 16px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

/* ===== SUMMARY ===== */

.summary {
  background: #ffe6e6;
  padding: 15px;
  border-radius: 8px;
  margin-top: 20px;
}

/* ===== BUTTON ===== */

.book-btn {
  width: 100%;
  padding: 12px;
  margin-top: 15px;
  background: #ff3b3b;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
}

.book-btn:hover {
  background: #e60000;
}
  </style>
</head>
<body>

<header>
  <h1>üåè Karishma Travel</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="destination.html">Destinations</a>
    <a href="booking.html">Booking</a>
     <a href="price.html">Price</a>
    <a href="confirmation.html">Confirmation</a>
  </nav>
</header>

<div class="booking-container">
  <form id="bookingForm">

    <label for="username">User Name</label>
    <input type="text" id="username" placeholder="Full Name" required>

    <label for="fromCity">From City</label>
    <select id="fromCity" required><option value="">From</option></select>

    <label for="toCity">To City</label>
    <select id="toCity" required><option value="">To</option></select>

    <label for="ticketType">Ticket Type</label>
    <select id="ticketType" required>
      <option value="Regular">Regular</option>
      <option value="AC Seat">AC Seat</option>
      <option value="NON-AC Seat">NON-AC Seat</option>
      <option value="Genral Seat">General Seat</option>
      <option value="Premium">Premium (+10%)</option>
    </select>

    <label for="passengers">Number of Passengers</label>
    <input type="number" id="passengers" min="1" value="1" required>

    <div class="summary" id="summary">
      <p><strong>Selected City:</strong> -</p>
      <p><strong>Price per Ticket:</strong> ‚Çπ0</p>
      <p><strong>Total Price:</strong> ‚Çπ0</p>
    </div>

    <button type="submit" class="book-btn">Confirm Booking</button>
  </form>
</div>
<script src="js/destinations.js"></script>

<script>
  // get HTML elements
  let fromCity = document.getElementById("fromCity");
  let toCity = document.getElementById("toCity");
  let ticketType = document.getElementById("ticketType");
  let numPassengers = document.getElementById("passengers");
  let summaryBox = document.getElementById("summary");
  let userName = document.getElementById("username");

  // ===== Fill city options =====
  let cityList = [];
  for (let type in destinations) {
    destinations[type].forEach(item => {
      if (!cityList.includes(item.name)) cityList.push(item.name);
    });
  }

  cityList.forEach(city => {
    fromCity.innerHTML += `<option value="${city}">${city}</option>`;
    toCity.innerHTML += `<option value="${city}">${city}</option>`;
  });

  // ===== Get data from URL (if any) =====
  let params = new URLSearchParams(window.location.search);
  let basePrice = Number(params.get("price")) || 500;
  let selectedPlace = params.get("place");
  if (selectedPlace) toCity.value = selectedPlace;

  // ===== Function to calculate city price factor =====
  function cityFactor(city) {
    if (city === "Nagpur") return 1;
    if (city === "Pune") return 1.3;
    if (city === "Mumbai") return 1.5;
    if (city === "Delhi") return 1.8;
    return 1.1;
  }

  // ===== Extra charge for ticket type =====
  function extraCharge(type) {
    if (type === "AC Seat") return 200;
    if (type === "NON-AC Seat") return 100;
    return 0;
  }

  // ===== Update summary section =====
  function updateSummary() {
    let from = fromCity.value || "-";
    let to = toCity.value || "-";
    let count = Number(numPassengers.value) || 1;

    let price = basePrice * cityFactor(from);

    if (ticketType.value === "Premium") {
      price = price * 1.10; // add 10%
    } else {
      price += extraCharge(ticketType.value);
    }

    price = Math.round(price);
    let total = price * count;

    summaryBox.innerHTML = `
      <p><b>Route:</b> ${from} ‚ûù ${to}</p>
      <p><b>Price per Ticket:</b> ‚Çπ${price}</p>
      <p><b>Total Price:</b> ‚Çπ${total}</p>`;
  }

  // update summary when user changes input
  fromCity.onchange = updateSummary;
  toCity.onchange = updateSummary;
  ticketType.onchange = updateSummary;
  numPassengers.oninput = updateSummary;

  // initial summary display
  updateSummary();

  // ===== Form submit =====
  document.getElementById("bookingForm").onsubmit = function(e) {
    e.preventDefault();

    let price = basePrice * cityFactor(fromCity.value);
    if (ticketType.value === "Premium") {
      price = price * 1.10;
    } else {
      price += extraCharge(ticketType.value);
    }

    price = Math.round(price);
    let total = price * numPassengers.value;

    // go to confirmation page with details
    window.location.href = 
      `confirmation.html?user=${userName.value}&from=${fromCity.value}&to=${toCity.value}&ticket=${ticketType.value}&passengers=${numPassengers.value}&price=${price}&total=${total}`;
  }
</script>

</body>
</html>
